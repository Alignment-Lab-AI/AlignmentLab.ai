{"version":3,"sources":["../../../../src/server/lib/incremental-cache/file-system-cache.ts"],"names":["LRUCache","path","NEXT_CACHE_TAGS_HEADER","NEXT_DATA_SUFFIX","NEXT_META_SUFFIX","RSC_PREFETCH_SUFFIX","RSC_SUFFIX","memoryCache","tagsManifest","FileSystemCache","constructor","ctx","fs","flushToDisk","serverDistDir","appDir","_appDir","pagesDir","_pagesDir","revalidatedTags","experimental","maxMemoryCacheSize","max","length","value","JSON","kind","stringify","props","Error","data","body","html","pageData","tagsManifestPath","join","loadTagsManifest","parse","readFileSync","err","version","items","revalidateTag","tag","revalidatedAt","Date","now","mkdir","dirname","writeFile","console","warn","get","args","key","tags","softTags","kindHint","process","env","NEXT_RUNTIME","filePath","getFilePath","fileData","readFile","mtime","stat","meta","replace","cacheEntry","lastModified","getTime","headers","status","_","detectFileKind","isAppPath","parsedData","storedTags","every","includes","set","ppr","postponed","cacheTags","tagsHeader","split","isStale","some","undefined","combinedTags","wasRevalidated","htmlPath","pathname","existsSync"],"mappings":"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"}